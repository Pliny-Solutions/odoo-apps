<?xml version="1.0"?>
<odoo>
    <record id="hr_training_action" model="ir.actions.act_window">
        <field name="name">Training List</field>
        <field name="res_model">hr.training</field>
        <field name="view_mode">tree,form</field>
        <field name="help" type="html">
          <p class="o_view_nocontent_smiling_face">
            Create a new Training
          </p>
        </field>
    </record>


    <record id="view_hr_training_tree" model="ir.ui.view">
        <field name="name">hr.training.tree</field>
        <field name="model">hr.training</field>
        <field name="arch" type="xml">
            <tree>
                <field name="name"/>
                <field name="start_date"/>
                <field name="end_date"/>
                <field name="employee_id"/>
                <field name="persons_trained"/>
                <field name="budget"/>
                <field name="state"/>
                <field name="amount_spent"/>
                <field name="funder_id"/>
            </tree>
        </field>
    </record>

		<!-- The stat button view list -->
    <record id="action_hr_training_trainee" model="ir.actions.act_window">
				<field name="name">Training Attendance</field>
				<field name="res_model">hr.training.trainee</field>
				<field name="view_mode">tree,form</field>
				<field name="domain">[('employee_id', '=', context.get('search_default_employee_id'))]</field>
		</record>


		<!-- List view by employees and the trainings they have attended -->
    <record id="view_hr_training_trainee_tree_with_training_data" model="ir.ui.view">
        <field name="name">hr.training.trainee.tree.training</field>
        <field name="model">hr.training.trainee</field>
        <field name="arch" type="xml">
            <tree>
                <field name="employee_id"/>
            </tree>
        </field>
    </record>

    <record id="action_hr_training_trainee_with_training" model="ir.actions.act_window">
        <field name="name">Employee Trainings</field>
        <field name="res_model">hr.training.trainee</field>
        <field name="view_mode">tree,form</field>
        <field name="view_id" ref="view_hr_training_trainee_tree_with_training_data"/>
    </record>

    <record id="view_hr_training_form" model="ir.ui.view">
        <field name="name">hr.training.form</field>
        <field name="model">hr.training</field>
        <field name="arch" type="xml">
            <form>
            <header>
            		<button name="action_approve" string="Approve" type="object" class="btn-primary"/>
                <button name="action_start" string="Start" type="object"  class="btn-secondary"/>
                <button name="action_complete" string="Complete" type="object" class="btn-success"/>
                <button name="action_cancel" string="Cancel" type="object" class="btn-danger"/>
                <button name="action_close" string="Close" type="object" class="btn-info"/>
                <field name="state" widget="statusbar" statusbar_visible="planned,approved,ongoing,done,cancelled,closed"/>
            </header>
                            <sheet>
                    <group>
                      <group>
                          <field name="name"/>
                          <field name="start_date" readonly="state == 'closed' or state == 'cancelled'"/>
                          <field name="end_date" readonly="state == 'closed' or state == 'cancelled'"/>
                          <field name="employee_id" readonly="state == 'closed' or state == 'cancelled'"/>
                          <field name="department_id" readonly="state == 'closed' or state == 'cancelled'"/>
                      </group>
                      <group>
                          <field name="budget" readonly="state == 'closed' or state == 'cancelled'"/>
                          <field name="amount_spent" readonly="state == 'closed' or state == 'cancelled'"/>
                          <field name="total_reimbursement" readonly="state == 'closed' or state == 'cancelled'"/>
                          <field name="total_expense" readonly="state == 'closed' or state == 'cancelled'"/>
                          <field name="funder_id" readonly="state == 'closed' or state == 'cancelled'"/>
                      </group>
                     </group>
                    <group>

                        <field name="description" readonly="state == 'closed' or state == 'cancelled'"/>
                        <field name="objective" readonly="state == 'closed' or state == 'cancelled'"/>
                        <field name="target" readonly="state == 'closed' or state == 'cancelled'"/>
                    </group>
                    <notebook>
                        <page string="Trainees">
                            <field name="trainee_ids"  readonly="state == 'closed' or state == 'cancelled'">
                                 <tree editable="bottom">
                                    <field name="employee_id"/>
                                    <field name="reimbursement"/>
                                    <field name="notes"/>
                                </tree>
                            </field>
                        </page>
                        <page string="Expenses">
                            <field name="expense_ids"  readonly="state == 'closed' or state == 'cancelled'">
                                <tree editable="bottom">
                                    <field name="name"/>
                                    <field name="employee_id"/>
                                    <field name="expense"/>
                                    <field name="notes"/>
                                </tree>
                            </field>
                        </page>
                        <page string="Attachments" >
                            <field name="attachment_ids" readonly="state == 'closed' or state == 'cancelled'">
                                <tree editable="bottom" >
                                    <field name="name"/>
                                    <field name="attachment_type"/>
                                    <field name="attachment" filename="name" widget="binary" />
                                </tree>
                            </field>
                        </page>
                    </notebook>
                </sheet>
            </form>
        </field>
    </record>

    <menuitem id="hr_training_menu_root" name="Training">

        <menuitem id="hr_training_menu" sequence="1"  name="Training"  action="hr_training_action"/>
        <menuitem id="hr_trainings_employee" sequence="2"  name="Employee List"  action="action_hr_training_trainee_with_training"/>
    </menuitem>

</odoo>
